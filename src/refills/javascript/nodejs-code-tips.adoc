---
rid: 1492530
bid: javascript
rcd: nodejs-code-tips
srcpath: javascript/nodejs-code-tips.adoc
title: Node.js CODE TIPS
category: JavaScript
date: 2017.4.19
layout: refill.jade
---

== ファイル読み込み

テキストファイルの読み込みである場合`'utf-8'`のようにエンコーディングを指定する。

- File System | Node.js Documentation
  * `link:https://nodejs.org/api/fs.html#fs_fs_readfilesync_path_options[fs.readFileSync(path\[, options\])]`
  * `link:https://nodejs.org/api/fs.html#fs_fs_readfile_path_options_callback[fs.readFile(path\[, options\], callback)]`

[source,javascript]
----
const fs = require('fs');

// sync
const text = fs.readFileSync('./input.txt', 'utf8');

// async
fs.readFile('./input.txt', 'utf8', function(err, text) {
  if (err) throw err;
  console.log(text);
});
----


== ファイル書き込み

[source,javascript]
----
require('fs').writeFile('out.txt', 'content', (e)=>{});
----


== 1列読み込み

.sample.txt
[source]
----
red
blue
green
yellow
----

[source,javascript]
----
const fs = require('fs');
const content = fs.readFileSync('sample.txt').toString();
const colors = content.trim().split('\n');
//=> [ 'red', 'blue', 'green', 'yellow' ]
----


== CSV読み込み

.sample.csv
[source]
----
fruit
apple
#banana
orange
lemon
----

.function readCsvSync
[source,javascript]
----
function readCsvSync(filename, options) {
  const fs = require('fs');
  const parse = require('csv-parse/lib/sync');
  const content = fs.readFileSync(filename).toString();
  return parse(content, options);
}
----

.use header
[source,javascript]
----
const options = { columns: true, comment: '#' };
const records = readCsvSync('sample.csv', options);
/*
[ { fruit: 'apple' },
  { fruit: 'orange' },
  { fruit: 'lemon' } ]
*/
----

.indicate columns
[source,javascript]
----
const options = { columns: ['id'], comment: '#' };
const records = readCsvSync('sample.csv', options);
/*
[ { id: 'fruit' },
  { id: 'apple' },
  { id: 'orange' },
  { id: 'lemon' } ]
*/
----


== tktk

- link:https://www.npmjs.com/package/tktk[tktk]
